extends Resource
class_name 物品资源类


enum 物品类型枚举 {
				全部,
				头盔,
				盔甲,
				腰带,
				靴子,
				盾牌,
				剑,
				护腕,
				裤子,
				戒指,
				项链,
				斧,
				锤,
				匕首,
				法杖,
				魔杖,
				弓,
				弩,
				翅膀,
				坐骑,
				消耗品,
				任务物品,
				材料,
				}

# 颜色定义 (RGB值参考暗黑2经典配色)
enum 品质颜色枚举 {
	白色 = 0,
	蓝色 = 1,
	黄色 = 2,
	绿色 = 3,
	橙色 = 4,
	紫色 = 5,
	金色 = 6,
	暗金 = 7
}
const 品质颜色 = {
	品质颜色枚举.白色: Color(0.9, 0.9, 0.9),
	品质颜色枚举.蓝色: Color(0.4, 0.4, 1.0),
	品质颜色枚举.黄色: Color(1.0, 0.9, 0.2),
	品质颜色枚举.绿色: Color(0.2, 0.8, 0.2),
	品质颜色枚举.橙色: Color(1.0, 0.5, 0.1),
	品质颜色枚举.紫色: Color(0.8, 0.2, 0.8),
	品质颜色枚举.金色: Color(0.9, 0.8, 0.1),
	品质颜色枚举.暗金: Color(0.6, 0.4, 0.1)
}

const 类型名称 = {
	物品类型枚举.全部: "全部",
	物品类型枚举.头盔: "头盔",
	物品类型枚举.盔甲: "盔甲",
	物品类型枚举.腰带: "腰带",
	物品类型枚举.靴子: "靴子",
	物品类型枚举.盾牌: "盾牌",
	物品类型枚举.剑: "剑",
	物品类型枚举.护腕: "护腕",
	物品类型枚举.裤子: "裤子",
	物品类型枚举.戒指: "戒指",
	物品类型枚举.项链: "项链",
	物品类型枚举.斧: "斧",
	物品类型枚举.锤: "锤",
	物品类型枚举.匕首: "匕首",
	物品类型枚举.法杖: "法杖",
	物品类型枚举.魔杖: "魔杖",
	物品类型枚举.弓: "弓",
	物品类型枚举.弩: "弩",
	物品类型枚举.翅膀: "翅膀",
	物品类型枚举.坐骑: "坐骑",
	物品类型枚举.消耗品: "消耗品",
	物品类型枚举.任务物品: "任务物品",
	物品类型枚举.材料: "材料"
}



@export var 物品品质 : 品质颜色枚举 = 品质颜色枚举.白色




@export var 列数 : int
@export var 行数 : int

@export var 物品类型 : 物品类型枚举
@export var 物品纹理 : Texture2D

@export var 物品名称 : String = "未命名物品"

@export_multiline var 物品描述 : String
@export var 物品属性 : Dictionary = {
	"基础属性": {
		"攻击力": 0,
		"防御力": 0,
		"耐久度": 100
	},
	"魔法属性": {
		"火焰伤害": 0,
		"吸血": 0.0,
		"攻击速度": 0.0
	}
}
# 新增获取颜色方法
func 获取颜色() -> Color:
	return 品质颜色.get(物品品质, Color.WHITE)
func 获取类型名称() -> String:
	return 类型名称.get(物品类型, "未知")

# 在 物品资源类.gd 中添加：
func 获取属性文本() -> String:
	var 显示文本 := ""
	
	# 安全获取基础属性（带默认值）
	var 基础属性 = 物品属性.get("基础属性", {})
	var 魔法属性 = 物品属性.get("魔法属性", {})
	
	# 基础属性显示（白色）
	if 基础属性.has("攻击力") and 基础属性["攻击力"] != 0:
		显示文本 += "攻击力: +%d\n" % 基础属性["攻击力"]
		
	if 基础属性.has("防御力") and 基础属性["防御力"] != 0:
		显示文本 += "防御力: +%d\n" % 基础属性["防御力"]
	
	# 耐久度总是显示
	if 基础属性.has("耐久度"):
		显示文本 += "耐久度: %d/100\n" % 基础属性.get("耐久度", 100)
	
	# 魔法属性显示（蓝色）
	for 属性 in 魔法属性:
		var 值 = 魔法属性[属性]
		if 值 != 0:
			var 格式值 = 值
			# 特殊处理百分比属性
			if 属性 in ["吸血", "攻击速度"]:
				格式值 = "%d%%" % (值)
				
			显示文本 += "[color=#00AAFF]%s: +%s[/color]\n" % [属性, 格式值]
	
	return 显示文本
	
